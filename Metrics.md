# Evaluation metrics
在機器學習和深度學習中，**評估指標** 對於量化模型的性能至關重要。在遞歸神經網路（RNNs）或其他深度學習模型中，指標的選擇取決於任務的類型（迴歸、分類或序列預測）。以下是常見的評估指標詳細說明：

---

## **迴歸指標**
### 1. **平均絕對誤差（Mean Absolute Error, MAE）**
   - **定義**：衡量預測值 $(\hat{y}$）與實際值（$y$）之間的平均誤差大小，而不考慮方向。
   - **公式**：
     $$\text{MAE} = \frac{1}{n} \sum_{i=1}^n |\hat{y}_i - y_i|$$
   - **範圍**： $[0, \infty)$。越低越好。
   - **解釋**：
     - 與 RMSE 相比，MAE 更容易理解且對異常值更具魯棒性。

---

### 2. **均方誤差（Mean Squared Error, MSE）**
   - **定義**：衡量預測值與實際值之間的平方差的平均值。
   - **公式**：
     $$\text{MSE} = \frac{1}{n} \sum_{i=1}^n (\hat{y}_i - y_i)^2$$
   - **範圍**： $[0, \infty)$。越低越好。
   - **解釋**：
     - MSE 比 MAE 更重視較大的誤差，因此對異常值更敏感。

---

### 3. **均方根誤差（Root Mean Squared Error, RMSE）**
   - **定義**：均方誤差的平方根，提供與目標變量相同單位的誤差。
   - **公式**：
     $$\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^n (\hat{y}_i - y_i)^2}$$
   - **範圍**： $[0, \infty)$。越低越好。
   - **解釋**：
     - 當較大的誤差特別不可取時，RMSE 很有用。

---

### 4. **$R^2$ 或判定係數（Coefficient of Determination）**
   - **定義**：衡量自變量解釋因變量（$y$）變異的比例。
   - **公式**：
      $$R^2 = 1 - \frac{\text{SS}_{\text{res}}}{\text{SS}_{\text{tot}}}$$ 
     其中：
     - $\text{SS}_{\text{res}} = \sum_{i=1}^n (\hat{y}_i - y_i)^2$ （殘差平方和）
     - $\text{SS}_{\text{tot}} = \sum_{i=1}^n (y_i - \bar{y})^2$ （總平方和）
   - **範圍**：$[-\infty, 1]$。越高越好。
     - $R^2 = 1$：完美預測。
     - $R^2 = 0$：模型效果與均值相同。
     - $R^2 < 0$：模型效果劣於均值。

---

## **分類指標**
### 1. **準確率（Accuracy）**
   - **定義**：正確預測標籤的百分比。
   - **公式**：
     $$\text{Accuracy} = \frac{\text{Number of correct predictions}}{\text{Total number of predictions}}$$
   - **範圍**： $[0, 1]$。越高越好。
   - **局限性**：
     - 對於不平衡數據集，準確率可能不足以反映模型性能（例如，多數類別的預測可能會導致高準確率，但對少數類別效果很差）。

---

### 2. **精確率（Precision）**
   - **定義**：所有預測為正的樣本中，實際為正的比例。
   - **公式**：
     $$\text{Precision} = \frac{TP}{TP + FP}$$
   - **範圍**：$[0, 1]$。越高越好。
   - **解釋**：
     - 高精確率意味著較少的假陽性。

---

### 3. **召回率（Recall, 敏感度或真正率）**
   - **定義**：實際為正的樣本中，預測為正的比例。
   - **公式**：
     $$\text{Recall} = \frac{TP}{TP + FN}$$
   - **範圍**：$[0, 1]$。越高越好。
   - **解釋**：
     - 高召回率意味著較少的假陰性。

---

### 4. **F1 分數（F1 Score）**

   - **定義**：精確率和召回率的調和平均數，用於平衡這兩者
   - **公式**：
     $$\text{F1 Score} = 2 \times \frac{\text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}$$
   - **範圍**：$[0, 1]$。越高越好。
   - **解釋**：
     - 適用於不平衡數據集。

---

### 5. **混淆矩陣（Confusion Matrix）**
   - **定義**：總結真正類（TP）、假正類（FP）、真負類（TN）和假負類（FN）的表格。
   - **示例**：

     |               | 預測為正 | 預測為負 |
     |---------------|----------|----------|
     | 實際為正      | TP       | FN       |
     | 實際為負      | FP       | TN       |

   - **用途**：幫助計算精確率、召回率和其他指標。

---

### 6. **ROC-AUC（接收者操作特徵曲線的面積）**
   - **定義**：評估真正率（敏感度）與假正率（1-特異性）之間的平衡。
   - **範圍**：$[0.5, 1]$。越高越好。
     - 0.5：隨機猜測。
     - 1：完美分類。

---

## **序列預測指標**
### 1. **困惑度（Perplexity，適用於 NLP 模型）**
   - **定義**：衡量語言模型中預測的不確定性。
   - **公式**：
     $$\text{Perplexity} = 2^{-\frac{1}{N} \sum_{i=1}^N \log_2(p(y_i))}$$
   - **範圍**：$[1, \infty)$。越低越好。
   - **解釋**：
     - 更低的困惑度表示序列任務（如文本生成）中的預測效果更好。

### 2. **編輯距離（Edit Distance，用於序列對齊）**
   - **定義**：計算將一個序列轉換為另一個序列所需的最少操作次數（插入、刪除或替換）。
   - **範圍**：$[0, \infty)$。越低越好。
   - **用途**：
     - 常用於語音識別或文本生成。

---

### 指標摘要表

| 指標            | 類型          | 適用場景                       |
|-----------------|--------------|------------------------------|
| MAE            | 迴歸         | 通用誤差測量                  |
| MSE            | 迴歸         | 重點懲罰較大的誤差             |
| RMSE           | 迴歸         | 與目標單位一致的誤差            |
| $$R^2$$        | 迴歸         | 解釋模型的變異性                |
| Accuracy       | 分類         | 平衡數據集                     |
| Precision      | 分類         | 假陽性較少                     |
| Recall         | 分類         | 假陰性較少                     |
| F1 Score       | 分類         | 不平衡數